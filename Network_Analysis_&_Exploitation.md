# Network Analysis and Exploitation

## Reconnaissance

When performing reconnaissance, a penetration tester has two options:

|Passive Network Recon|Active Network Recon|
|---|---|
|- Hard to detect by Blue Teams |- Easily Detectable by Blue Team or Target Devices|
|- Non-Disruptive|- Can be disruptive to IoT Endpoints|
|- Sniffing traffic|- Scanning|
|- Switches|- Ports, fingerprinting, fuzzing|
|- Port Mirrors|- SSL stripping, MiTM|
|- Taps||

### Passive Recon

Performing passive recon means that an attacker does not directly interact with any of the target systems. Instead, they take advantage of publicly available data sources and sniff network traffic by monitoring broadcast communications or network taps.

Passive recon is useful because it is hard to detect and does not have any impact on the target system. However, the information that can be gathered via passive recon is limited to what is available in open data sources or visible on the network.

### Active Recon

In active recon, a penetration tester interacts with the target devices. This can include performing port and vulnerability scanning, fuzzing, machine-in-the-middle (MitM) attacks and other active information gathering.

Active recon can provide more and more useful information because the attacker actively gathers data of interest. However, this technique is more detectable and runs the risk of crashing unstable target devices and services.

### Wireshark

![ws-main](https://github.com/vsang181/IoT-Penetration-testing/assets/28651683/4e0aefa2-8468-41fb-a71d-f03b8b9c5c7c)

[Download Link](https://www.wireshark.org/download.html)

Wireshark is one of the most widely used tools for passive recon. It is a freely available network analysis tool with a user-friendly GUI and a great deal of functionality under the hood. Wireshark’s numerous built-in protocol dissectors break packets into their component fields and label them in a display for the user.

Wireshark can parse a packet capture file or collect network traffic live, making it ideal for passive reconnaissance. Based on the various fields contained within a packet, a penetration tester can filter traffic to focus on certain types (such as IoT device communications) or follow a particular device’s communications or a conversation.

![image](https://github.com/vsang181/IoT-Penetration-testing/assets/28651683/83d6d941-a4b4-410e-8d3a-dc4b4004af73)

> Wireshark can capture Network Information for most Protocols used in IoT including:
> - HTTP
> - TCP
> - TLS/SSL
> - MQTT
> - DNS
> - BlueTooth
> - ZigBee

IoT devices use a variety of different protocols to communicate. At the application layer, MQTT, HTTP and DNS are common, but devices may also use protocols like Telnet or custom protocols. IoT devices may also use TLS/SSL to protect device communications.

Lower down the protocol stack, it is important to consider that IoT devices are not limited to Wi-Fi. They also use Bluetooth, ZigBee, and similar protocols.

Wireshark offers support for most network protocols used by IoT devices, making it easy to analyze IoT device traffic. It’s also possible to specify which dissector should be used for traffic over a particular port and to add custom dissectors for new protocols.

### tcpdump

> Captures Traffic on an interface that can be used to analyze with Wireshark. Any communication travelling through the network interface can be captured.

|Switch|Syntax|Description|
|---|---|---|
|‐i eth0|tcpdump –i eth0|Capture traffic from specific interface|
|‐D|tcpdump –D|Show available interfaces|
|port 80|tcpdump –i eth0 port 80|Capture traffic from specific port|
|‐w file.pcap|tcpdump –i eth0 –w dump.pcap|Dump captured traffic to a file (i.e. pcap)|
|<service>|tcpdump http|Capture traffic from specific service protocol|
|src|tcpdump src 10.1.1.100|Capture traffic from specific source|
|dst|tcpdump dst 10.1.1.10|Capture traffic to specific destination|

> Setting the snap length to capture the whole packet (-s0) is also helpful.

Wireshark is capable of capturing its own network traffic for analysis, but this is not the only option. It is also possible to capture traffic and save it to a packet capture file for later analysis.

One way of doing this is by using tcpdump, which can capture any traffic flowing over the network interface. As shown above, tcpdump has the ability to filter traffic and only save the packets that match the defined rules. By filtering to only capture traffic for IoT devices or using IoT protocols, these filters can make traffic captures more efficient and limits the size of the resulting packet capture file.

.
.
.
.
.
.
_In progress..._

## Let's Connect

I welcome your insights, feedback, and opportunities for collaboration. Together, we can make the digital world safer, one challenge at a time.

- **LinkedIn**: (https://www.linkedin.com/in/aashwadhaama/)

I look forward to connecting with fellow cybersecurity enthusiasts and professionals to share knowledge and work together towards a more secure digital environment.
